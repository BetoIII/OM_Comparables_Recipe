{
  "version": "1.0.0",
  "title": "Commercial Real Estate OM Comparables Extraction (CSV)",
  "description": "Extract market comparable properties from Offering Memorandum documents and export to CSV format. Outputs two files: comparables_data.csv (properties) and comparables_data_units.csv (unit details). View at http://localhost:3001/comparables",
  "instructions": "Extract comparable properties from Offering Memorandum PDFs and export to CSV format. Process each PDF, find the comparables section, extract property and unit data, and REPLACE (not merge) the contents of output/comparables_data.csv and output/comparables_data_units.csv. View the results in the Next.js app (comparables-app) running on port 3001.",
  "extensions": [
    {
      "name": "developer",
      "type": "builtin",
      "display_name": "Developer",
      "timeout": 900,
      "bundled": true,
      "description": "Read and analyze files, search codebase, and access project structure"
    },
    {
      "name": "pdfreader",
      "type": "stdio",
      "cmd": "uvx mcp-read-pdf",
      "args": [],
      "timeout": 900,
      "description": "Read large and complex PDF documents"
    },
    {
      "name": "todo",
      "type": "builtin",
      "display_name": "To-Do",
      "timeout": 300,
      "bundled": true,
      "description": "Track task progress and manage to-do lists"
    }
  ],
  "prompt": "TASK: Extract comparable properties from commercial real estate Offering Memorandum PDFs and export to CSV format.\n\nDOCUMENTS: {{ document_paths }}\n\nIMPORTANT: This extraction will REPLACE any existing CSV files in output/. Each run represents a fresh set of comparables from the latest documents.\n\nSTEPS:\n\n1. READ EACH PDF\n   - Use pdfreader extension to read the PDF content\n\n2. FIND COMPARABLES SECTION\n   - Look for: 'Market Comparables', 'Competitive Set', 'Comparable Properties', 'Market Analysis', 'Rent Comparables', 'Market Survey'\n   - Skip the subject property (the one being marketed)\n\n3. EXTRACT CORE DATA (required for each property):\n   - property_name\n   - full_address (as single string)\n   - basic_info object:\n     * property_type (required: Multifamily, Office, Retail, etc.)\n     * total_units (if shown)\n     * total_square_feet (if shown)\n     * year_built (if shown)\n     * year_renovated (if shown)\n     * occupancy_rate (if shown, as percentage 0-100)\n   - source_document (filename)\n\n4. ADD OPTIONAL DATA (if easily found):\n   - distance_from_subject: distance from subject property (e.g., '0.5 miles', '2 blocks')\n   - units_detail array: unit_type, square_feet, rent (as shown: '$1,500/month', '$25/sf/year', etc.)\n   - notes: any other info (amenities, etc.)\n\n5. CREATE TWO CSV FILES\n   \n   A. PRIMARY FILE: output/comparables_data.csv\n   Columns: property_name, full_address, property_type, total_units, total_square_feet, year_built, year_renovated, occupancy_rate, distance_from_subject, notes, source_document\n   \n   Format:\n   - Include header row\n   - Quote fields containing commas or newlines\n   - Leave empty for null/missing values\n   - One row per property\n   \n   B. UNITS FILE: output/comparables_data_units.csv\n   Columns: property_name, unit_type, square_feet, rent\n   \n   Format:\n   - Include header row\n   - Foreign key: property_name (links to primary file)\n   - One row per unit\n   - Only create this file if at least one property has units_detail\n   - If no units_detail found, create empty file with just headers\n\n6. ALSO CREATE JSON FILE\n   - Create output/comparables_data.json with the same data\n   - This ensures web server can still read the data\n   - Use same JSON structure as comparables_search_json.json recipe\n\n7. FINAL OUTPUT MESSAGE\n   After completing the extraction, display this message to the user:\n\n   âœ… Comparables extraction complete (CSV format)!\n   ðŸ“Š Data saved to:\n      - output/comparables_data.csv (properties)\n      - output/comparables_data_units.csv (unit details)\n      - output/comparables_data.json (for web app)\n   \n   View your results in the Next.js app:\n   http://localhost:3001/comparables\n   \n   (If the Next.js app isn't running, run: goose run start-here)\n   \n   ðŸ’¡ Tip: Use the comp set management tools in the app to save properties you want to keep before running another extraction.\n\nFOCUS: Get the core fields first. Add optional fields only if clearly visible. Don't spend time searching for missing data.",
  "response": {
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "type": "object",
    "properties": {
      "comparable_properties": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "property_name": {
              "type": "string",
              "description": "Name of the comparable property"
            },
            "full_address": {
              "type": "string",
              "description": "Complete address as a single string (e.g., '123 Main St, Austin, TX 78701')"
            },
            "basic_info": {
              "type": "object",
              "properties": {
                "property_type": {
                  "type": "string",
                  "description": "Type of property (e.g., 'Multifamily', 'Office', 'Retail')"
                },
                "total_units": {
                  "type": ["integer", "null"],
                  "description": "Total number of units/spaces"
                },
                "total_square_feet": {
                  "type": ["number", "null"],
                  "description": "Total square footage"
                },
                "year_built": {
                  "type": ["integer", "null"],
                  "description": "Year constructed"
                },
                "year_renovated": {
                  "type": ["integer", "null"],
                  "description": "Year of last major renovation if applicable"
                },
                "occupancy_rate": {
                  "type": ["number", "null"],
                  "description": "Occupancy rate as a percentage (0-100)"
                }
              },
              "required": ["property_type"],
              "description": "Core property information"
            },
            "distance_from_subject": {
              "type": ["string", "null"],
              "description": "Distance from the subject property (e.g., '0.5 miles', '2 blocks')"
            },
            "units_detail": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "unit_type": {
                    "type": "string",
                    "description": "Unit type (e.g., 'Studio', '1BR/1BA', '2BR/2BA')"
                  },
                  "square_feet": {
                    "type": ["number", "null"],
                    "description": "Square footage"
                  },
                  "rent": {
                    "type": ["string", "null"],
                    "description": "Rent as shown in document (e.g., '$1,500/month', '$18,000/year', '$2.50/sf/month')"
                  }
                },
                "required": ["unit_type"],
                "description": "Unit information if available"
              },
              "description": "Optional: List of unit types (include if data is available)"
            },
            "notes": {
              "type": ["string", "null"],
              "description": "Optional: Any additional info (amenities, occupancy, distance, etc.)"
            },
            "source_document": {
              "type": "string",
              "description": "Filename of the source OM document"
            }
          },
          "required": ["property_name", "full_address", "basic_info", "source_document"],
          "description": "A comparable property with core required fields and optional enrichment"
        },
        "description": "Array of comparable properties"
      },
      "summary": {
        "type": "object",
        "properties": {
          "total_properties": {
            "type": "integer",
            "description": "Total number of comparable properties extracted"
          },
          "documents_processed": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of source document filenames processed"
          }
        },
        "required": ["total_properties", "documents_processed"],
        "description": "Simple summary statistics"
      }
    },
    "required": ["comparable_properties", "summary"],
    "additionalProperties": false
  },
  "parameters": [
    {
      "key": "document_paths",
      "description": "Array of file paths to the Offering Memorandum PDF documents to process (e.g. /path/to/document1.pdf, /path/to/document2.pdf)",
      "input_type": "string",
      "requirement": "required"
    }
  ],
  "settings": {
    "temperature": 0.0
  },
  "retry": {
    "max_retries": 3,
    "timeout_seconds": 300,
    "checks": [
      {
        "type": "shell",
        "command": "test -f output/comparables_data.csv && test -s output/comparables_data.csv && test -f output/comparables_data.json && test -s output/comparables_data.json"
      }
    ],
    "on_failure": "echo 'Retry failed. Missing or empty CSV or JSON output files.'"
  }
}
